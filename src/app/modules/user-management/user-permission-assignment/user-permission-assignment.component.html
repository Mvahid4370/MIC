<!-- pop up messages -->
<p-toast key="userPermissionAssignment" position="bottom-left"></p-toast>

<!-- data table -->
<section class="section">
  <!-- <div class="card">
    <div class="card-body"> -->
  <div class="card-text pt-3"></div>
  <!-- input group -->
  <div class="pb-2">
    <p-panel class="search-panel__secation pb-1" header="سطح دسترسی ناظرین">
      <div class="container">
        <div class="row row-cols-lg-2 row-cols-1 pb-3">
          <!-- عنوان‌ها -->
          <div class="col my-1">
            <label for="selectUser">انتخاب کاربر</label>
            <p-dropdown
              id="selectUser"
              class="col"
              styleClass="w-100 my-1"
              optionLabel="firstName"
              [options]="supervisors"
              [(ngModel)]="selectedSupervisor"
              [filter]="true"
              placeholder="انتخاب کنید"
              (onChange)="getCompanyTree(selectedSupervisor.userId)">
              <ng-template pTemplate="selectedItem">
                <div>
                  {{
                    selectedSupervisor.firstName +
                      ' ' +
                      selectedSupervisor.lastName
                  }}
                </div>
              </ng-template>
              <ng-template let-supervisor pTemplate="item">
                <div>
                  {{ supervisor.firstName + ' ' + supervisor.lastName }}
                </div>
              </ng-template>
            </p-dropdown>
          </div>
          <div class="col my-1">
            <label for="nationalCode">کد ملی</label>
            <input
              id="nationalCode"
              pInputText
              type="text"
              class="w-100"
              [disabled]="true"
              [ngModel]="selectedSupervisor.nationalId | faNum" />
          </div>
          <!-- / عنوان‌ها -->
        </div>

        <!-- <div class="row row-cols-lg-3 row-cols-1"> -->
        <!-- نام -->
        <!-- <div class="col my-1">
                <label for="name">نام</label>
                <input
                  id="name"
                  pInputText
                  type="text"
                  class="w-100"
                  [disabled]="true"
                  [ngModel]="selectedSupervisor.firstName" />
              </div> -->
        <!-- / نام -->

        <!-- نام خانوادگی -->
        <!-- <div class="col my-1">
                <label for="lastName">نام خانوادگی</label>
                <input
                  id="lastName"
                  pInputText
                  type="text"
                  class="w-100"
                  [disabled]="true"
                  [ngModel]="selectedSupervisor.lastName" />
              </div> -->
        <!-- / نام خانوادگی -->

        <!-- کد ملی -->
        <!-- <div class="col my-1">
                <label for="nationalCode">کد ملی</label>
                <input
                  id="nationalCode"
                  pInputText
                  type="text"
                  class="w-100"
                  [disabled]="true"
                  [ngModel]="selectedSupervisor.nationalId | faNum" />
              </div> -->
        <!-- / کد ملی -->
        <!-- </div> -->

        <div class="row row-cols-lg-1 row-cols-1 pt-3">
          <!-- سطح دسترسی -->
          <div class="col my-1 text-center">
            <p-tree
              selectionMode="checkbox"
              class="w-full md:w-30rem"
              [value]="permissions"
              [propagateSelectionUp]="false"
              [propagateSelectionDown]="false"
              [(selection)]="selectedPermissions"
              (onNodeSelect)="addPermission($event.node)"
              (onNodeUnselect)="removePermission($event.node)"></p-tree>
          </div>
          <!-- / سطح دسترسی -->
        </div>

        <!-- دکمه ها -->
        <div
          class="d-flex justify-content-center justify-content-md-end pt-3 w-100">
          <p-button
            class="pe-2"
            styleClass="p-button-success"
            label="تایید"
            icon="pi pi-check"
            (click)="
              assignPermissionsToUser(
                selectedSupervisor.userId,
                permissionIdList
              )
            "></p-button>

          <!-- <p-button
                class="pe-2"
                styleClass="p-button-warning"
                label="انصراف"
                icon="pi pi-times"></p-button> -->
        </div>
        <!-- / دکمه ها -->
      </div>
    </p-panel>
  </div>
  <!-- / input group -->
  <!-- </div>
  </div> -->
</section>
<!-- / data table -->
